# SPA fallback for React/Vite (Apache)
RewriteEngine On
RewriteBase /

# Serve existing files/directories as-is
RewriteCond %{REQUEST_FILENAME} -f [OR]
RewriteCond %{REQUEST_FILENAME} -d
RewriteRule ^ - [L]

# Map explicit API endpoints for blog (works even se /api/.htaccess nÃ£o aplicar)
RewriteRule ^api/blog-posts/search$ api/blog-posts-search.php [L,NC]
RewriteRule ^api/blog-posts/categories$ api/blog-posts-categories.php [L,NC]
RewriteRule ^api/blog-posts/?$ api/blog-posts.php [L,NC]
RewriteRule ^api/blog-posts/([A-Za-z0-9-]+)$ api/blog-posts-by-slug.php?slug=$1 [L,NC]

# Do not rewrite backend paths or PHP blog
RewriteCond %{REQUEST_URI} ^/(api|blog|server|backend) [NC]
RewriteRule ^ - [L]

# Allow common static assets
RewriteRule ^(assets/|images/|img/|team/|fonts/|css/|js/|favicon\.ico$|robots\.txt$|sitemap\.xml$) - [L,NC]

# Everything else -> index.html (SPA)
RewriteRule . /index.html [L]

# Optional caching for static assets
<IfModule mod_expires.c>
  ExpiresActive On
  ExpiresByType text/html "access plus 0 seconds"
  ExpiresByType text/css "access plus 1 week"
  ExpiresByType application/javascript "access plus 1 week"
  ExpiresByType image/* "access plus 1 month"
</IfModule>
